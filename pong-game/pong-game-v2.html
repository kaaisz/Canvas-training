<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Pong Game - Pt.2</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!-- <link rel="stylesheet" type="text/css" media="screen" href="main.css" /> -->
    <!-- <script src="main.js"></script> -->
    <style>
        html, body{
            margin:0;
            padding:0;
            overflow:hidden;/*to unscrollable this page*/
            width:100%;
            height:100%;
        }
        body{
            display:flex;
            align-items:center;
            justify-content: center;
        }
        #game-canvas{
            background:black;
        }
    </style>
</head>
<body>
    <canvas id="game-canvas"></canvas>
    <script>
        //setup canvas
        var boardWidth = 512;
        var boardHeight = 256;
        var canvas; //for global variable to refer from everywhere
        var context;//to activate functions of canvas

        //setup time for calc elapsed time
        var counter = 0;
        var lastTime;//variable for store the time for last frame

        //this is for initialise each variable and add event handler.
        function init(){
            //set width and height for canvas
            canvas = document.getElementById("game-canvas");
            canvas.width = boardWidth;
            canvas.height = boardHeight;
            //to preparing to render, get 2d context by using this below
            context = canvas.getContext("2d");

            lastTime = performance.now();//store current time(as ms by using performance.now()) 
        }
        
        //this is for updating condition of this game
        function update(dt){
            counter += 1;
            console.log(counter);//counter will increase when update has been invoked 
        }

        //this is for rendering condition on canvas
        function render(dt){
            //draw circle
            context.fillStyle = "white";//set the fillStyle to white
            context.beginPath();
            context.arc(100, 100, 9, 0, 2*Math.PI);
            context.fill();
        }

        //this is for invoking update() and render()
        function main(){
            var now = performance.now();
            var dt = now - lastTime;
            var maxFrameTime = 1000 / 60;

            if(dt > maxFrameTime){
                dt = maxFrameTime;
            }
            
            /*
            pass dt(time difference between last frame and current time) 
            as a parameter for both update() and render() to update conditions 
            of each frames
            */
            update(dt);
            render(dt);
            //add current time to update the time last frame has done
            lastTime = now;

            requestAnimationFrame(main);
            /*
            by using this function to invoke itself, 
            you can make loop to invoke main() per 16ms when main has been executed.
            * when you want to pass function itself as a parameter, use function name as parameter(in case of "main()" must be name as "main").
            * requestAnimationFrame is useful for game or animation due to be able to stop/intrrupt loop when it's not needed.
            */
        }

        //execute funciton
        init();//initialise game
        main();//starting loop
    </script>
</body>
</html>